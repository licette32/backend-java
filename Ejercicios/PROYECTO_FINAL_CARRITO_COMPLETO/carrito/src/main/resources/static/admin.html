# <!DOCTYPE html>
# <html lang="es">
# <head>
#     <meta charset="UTF-8">
#     <meta name="viewport" content="width=device-width, initial-scale=1.0">
#     <title>Administración - CarritoTech</title>
#     <!-- Bootstrap 5.0 CSS -->
#     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
#     <!-- Bootstrap Icons -->
#     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
#     <!-- Custom CSS -->
#     <link href="css/styles.css" rel="stylesheet">
# </head>
# <body>
#     <!-- Header -->
#     <header class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
#         <div class="container">
#             <a class="navbar-brand fw-bold" href="index.html">
#                 <i class="bi bi-cart3"></i> CarritoTech
#             </a>
            
#             <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
#                 <span class="navbar-toggler-icon"></span>
#             </button>
            
#             <div class="collapse navbar-collapse" id="navbarNav">
#                 <ul class="navbar-nav me-auto">
#                     <li class="nav-item">
#                         <a class="nav-link" href="index.html">
#                             <i class="bi bi-house"></i> Inicio
#                         </a>
#                     </li>
#                     <li class="nav-item">
#                         <a class="nav-link" href="productos.html">
#                             <i class="bi bi-grid"></i> Productos
#                         </a>
#                     </li>
#                     <li class="nav-item">
#                         <a class="nav-link" href="clientes.html">
#                             <i class="bi bi-people"></i> Clientes
#                         </a>
#                     </li>
#                     <li class="nav-item">
#                         <a class="nav-link active" href="admin.html">
#                             <i class="bi bi-gear"></i> Admin
#                         </a>
#                     </li>
#                 </ul>
                
#                 <div class="d-flex align-items-center">
#                     <a href="carrito.html" class="btn btn-outline-light position-relative me-3">
#                         <i class="bi bi-cart2"></i> Carrito
#                         <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
#                             0
#                         </span>
#                     </a>
                    
#                     <div class="dropdown">
#                         <button class="btn btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
#                             <i class="bi bi-person"></i> Cliente
#                         </button>
#                         <ul class="dropdown-menu dropdown-menu-end">
#                             <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">Iniciar Sesión</a></li>
#                             <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#registerModal">Registrarse</a></li>
#                             <li><hr class="dropdown-divider"></li>
#                             <li><a class="dropdown-item" href="#" id="logout-btn" style="display: none;">Cerrar Sesión</a></li>
#                         </ul>
#                     </div>
#                 </div>
#             </div>
#         </div>
#     </header>

#     <!-- Main Content -->
#     <main class="py-4">
#         <div class="container">
#             <!-- Encabezado de la página -->
#             <div class="row mb-4">
#                 <div class="col-12">
#                     <h1 class="display-5 fw-bold text-center mb-4">Panel de Administración</h1>
#                     <p class="lead text-center text-muted">Gestiona productos y pedidos</p>
#                 </div>
#             </div>

#             <!-- Contenedor de alertas -->
#             <div id="alert-container"></div>

#             <!-- Pestañas de navegación -->
#             <div class="row mb-4">
#                 <div class="col-12">
#                     <ul class="nav nav-tabs" id="adminTabs" role="tablist">
#                         <li class="nav-item" role="presentation">
#                             <button class="nav-link active" id="productos-tab" data-bs-toggle="tab" data-bs-target="#productos" type="button" role="tab">
#                                 <i class="bi bi-box-seam"></i> Productos
#                             </button>
#                         </li>
#                         <li class="nav-item" role="presentation">
#                             <button class="nav-link" id="pedidos-tab" data-bs-toggle="tab" data-bs-target="#pedidos" type="button" role="tab">
#                                 <i class="bi bi-receipt"></i> Pedidos
#                             </button>
#                         </li>
#                         <li class="nav-item" role="presentation">
#                             <button class="nav-link" id="estadisticas-tab" data-bs-toggle="tab" data-bs-target="#estadisticas" type="button" role="tab">
#                                 <i class="bi bi-graph-up"></i> Estadísticas
#                             </button>
#                         </li>
#                     </ul>
#                 </div>
#             </div>

#             <!-- Contenido de las pestañas -->
#             <div class="tab-content" id="adminTabsContent">
#                 <!-- Pestaña de Productos -->
#                 <div class="tab-pane fade show active" id="productos" role="tabpanel">
#                     <div class="row mb-3">
#                         <div class="col-md-8">
#                             <div class="input-group">
#                                 <input type="text" class="form-control" id="searchProductos" placeholder="Buscar productos...">
#                                 <button class="btn btn-outline-secondary" type="button" id="searchProductosBtn">
#                                     <i class="bi bi-search"></i>
#                                 </button>
#                             </div>
#                         </div>
#                         <div class="col-md-4 text-end">
#                             <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#productoModal">
#                                 <i class="bi bi-plus-circle"></i> Nuevo Producto
#                             </button>
#                         </div>
#                     </div>

#                     <div class="card">
#                         <div class="card-header">
#                             <h5 class="mb-0">
#                                 <i class="bi bi-box-seam"></i> Gestión de Productos
#                             </h5>
#                         </div>
#                         <div class="card-body">
#                             <div class="table-responsive">
#                                 <table class="table table-striped table-hover">
#                                     <thead>
#                                         <tr>
#                                             <th>ID</th>
#                                             <th>Nombre</th>
#                                             <th>Descripción</th>
#                                             <th>Precio</th>
#                                             <th>Stock</th>
#                                             <th>Estado</th>
#                                             <th>Acciones</th>
#                                         </tr>
#                                     </thead>
#                                     <tbody id="productos-table-body">
#                                         <tr>
#                                             <td colspan="7" class="text-center py-4">
#                                                 <div class="spinner-border text-dark" role="status">
#                                                     <span class="visually-hidden">Cargando productos...</span>
#                                                 </div>
#                                             </td>
#                                         </tr>
#                                     </tbody>
#                                 </table>
#                             </div>
#                         </div>
#                     </div>
#                 </div>

#                 <!-- Pestaña de Pedidos -->
#                 <div class="tab-pane fade" id="pedidos" role="tabpanel">
#                     <div class="row mb-3">
#                         <div class="col-md-6">
#                             <select class="form-select" id="filtroEstado">
#                                 <option value="">Todos los estados</option>
#                                 <option value="PENDIENTE">Pendiente</option>
#                                 <option value="PROCESANDO">Procesando</option>
#                                 <option value="ENVIADO">Enviado</option>
#                                 <option value="ENTREGADO">Entregado</option>
#                                 <option value="CANCELADO">Cancelado</option>
#                             </select>
#                         </div>
#                         <div class="col-md-6">
#                             <input type="date" class="form-control" id="filtroFecha">
#                         </div>
#                     </div>

#                     <div class="card">
#                         <div class="card-header">
#                             <h5 class="mb-0">
#                                 <i class="bi bi-receipt"></i> Gestión de Pedidos
#                             </h5>
#                         </div>
#                         <div class="card-body">
#                             <div class="table-responsive">
#                                 <table class="table table-striped table-hover">
#                                     <thead>
#                                         <tr>
#                                             <th>ID</th>
#                                             <th>Cliente</th>
#                                             <th>Fecha</th>
#                                             <th>Total</th>
#                                             <th>Estado</th>
#                                             <th>Acciones</th>
#                                         </tr>
#                                     </thead>
#                                     <tbody id="pedidos-table-body">
#                                         <tr>
#                                             <td colspan="6" class="text-center py-4">
#                                                 <div class="spinner-border text-dark" role="status">
#                                                     <span class="visually-hidden">Cargando pedidos...</span>
#                                                 </div>
#                                             </td>
#                                         </tr>
#                                     </tbody>
#                                 </table>
#                             </div>
#                         </div>
#                     </div>
#                 </div>

#                 <!-- Pestaña de Estadísticas -->
#                 <div class="tab-pane fade" id="estadisticas" role="tabpanel">
#                     <div class="row">
#                         <div class="col-md-3 mb-4">
#                             <div class="card bg-primary text-white">
#                                 <div class="card-body">
#                                     <div class="d-flex justify-content-between">
#                                         <div>
#                                             <h6 class="card-title">Total Productos</h6>
#                                             <h3 id="stat-productos">0</h3>
#                                         </div>
#                                         <div class="align-self-center">
#                                             <i class="bi bi-box-seam display-4"></i>
#                                         </div>
#                                     </div>
#                                 </div>
#                             </div>
#                         </div>
#                         <div class="col-md-3 mb-4">
#                             <div class="card bg-success text-white">
#                                 <div class="card-body">
#                                     <div class="d-flex justify-content-between">
#                                         <div>
#                                             <h6 class="card-title">Total Clientes</h6>
#                                             <h3 id="stat-clientes">0</h3>
#                                         </div>
#                                         <div class="align-self-center">
#                                             <i class="bi bi-people display-4"></i>
#                                         </div>
#                                     </div>
#                                 </div>
#                             </div>
#                         </div>
#                         <div class="col-md-3 mb-4">
#                             <div class="card bg-warning text-white">
#                                 <div class="card-body">
#                                     <div class="d-flex justify-content-between">
#                                         <div>
#                                             <h6 class="card-title">Total Pedidos</h6>
#                                             <h3 id="stat-pedidos">0</h3>
#                                         </div>
#                                         <div class="align-self-center">
#                                             <i class="bi bi-receipt display-4"></i>
#                                         </div>
#                                     </div>
#                                 </div>
#                             </div>
#                         </div>
#                         <div class="col-md-3 mb-4">
#                             <div class="card bg-info text-white">
#                                 <div class="card-body">
#                                     <div class="d-flex justify-content-between">
#                                         <div>
#                                             <h6 class="card-title">Productos Activos</h6>
#                                             <h3 id="stat-productos-activos">0</h3>
#                                         </div>
#                                         <div class="align-self-center">
#                                             <i class="bi bi-check-circle display-4"></i>
#                                         </div>
#                                     </div>
#                                 </div>
#                             </div>
#                         </div>
#                     </div>
#                 </div>
#             </div>
#         </div>
#     </main>

#     <!-- Footer -->
#     <footer class="bg-dark text-white py-4">
#         <div class="container">
#             <div class="row">
#                 <div class="col-md-6">
#                     <h5><i class="bi bi-cart3"></i> CarritoTech</h5>
#                     <p class="text-muted">Tu tienda de tecnología de confianza.</p>
#                 </div>
#                 <div class="col-md-6 text-md-end">
#                     <p class="text-muted mb-0">
#                         &copy; 2024 CarritoTech - Talento Tech. Todos los derechos reservados.
#                     </p>
#                 </div>
#             </div>
#         </div>
#     </footer>

#     <!-- Modal de Producto -->
#     <div class="modal fade" id="productoModal" tabindex="-1">
#         <div class="modal-dialog modal-lg">
#             <div class="modal-content">
#                 <div class="modal-header">
#                     <h5 class="modal-title" id="productoModalTitle">Nuevo Producto</h5>
#                     <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
#                 </div>
#                 <div class="modal-body">
#                     <form id="productoForm">
#                         <input type="hidden" id="productoId">
#                         <div class="mb-3">
#                             <label for="productoNombre" class="form-label">Nombre *</label>
#                             <input type="text" class="form-control" id="productoNombre" required>
#                         </div>
#                         <div class="mb-3">
#                             <label for="productoDescripcion" class="form-label">Descripción</label>
#                             <textarea class="form-control" id="productoDescripcion" rows="3"></textarea>
#                         </div>
#                         <div class="row">
#                             <div class="col-md-6 mb-3">
#                                 <label for="productoPrecio" class="form-label">Precio *</label>
#                                 <input type="number" class="form-control" id="productoPrecio" step="0.01" required>
#                             </div>
#                             <div class="col-md-6 mb-3">
#                                 <label for="productoStock" class="form-label">Stock *</label>
#                                 <input type="number" class="form-control" id="productoStock" required>
#                             </div>
#                         </div>
#                         <div class="mb-3">
#                             <div class="form-check">
#                                 <input class="form-check-input" type="checkbox" id="productoActivo" checked>
#                                 <label class="form-check-label" for="productoActivo">
#                                     Producto activo
#                                 </label>
#                             </div>
#                         </div>
#                     </form>
#                 </div>
#                 <div class="modal-footer">
#                     <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
#                     <button type="button" class="btn btn-dark" id="guardarProductoBtn">Guardar Producto</button>
#                 </div>
#             </div>
#         </div>
#     </div>

#     <!-- Modal de Actualizar Estado de Pedido -->
#     <div class="modal fade" id="estadoPedidoModal" tabindex="-1">
#         <div class="modal-dialog">
#             <div class="modal-content">
#                 <div class="modal-header">
#                     <h5 class="modal-title">Actualizar Estado del Pedido</h5>
#                     <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
#                 </div>
#                 <div class="modal-body">
#                     <form id="estadoPedidoForm">
#                         <input type="hidden" id="pedidoIdEstado">
#                         <div class="mb-3">
#                             <label for="nuevoEstado" class="form-label">Nuevo Estado</label>
#                             <select class="form-select" id="nuevoEstado" required>
#                                 <option value="">Selecciona un estado</option>
#                                 <option value="PENDIENTE">Pendiente</option>
#                                 <option value="PROCESANDO">Procesando</option>
#                                 <option value="ENVIADO">Enviado</option>
#                                 <option value="ENTREGADO">Entregado</option>
#                                 <option value="CANCELADO">Cancelado</option>
#                             </select>
#                         </div>
#                     </form>
#                 </div>
#                 <div class="modal-footer">
#                     <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
#                     <button type="button" class="btn btn-dark" id="actualizarEstadoBtn">Actualizar Estado</button>
#                 </div>
#             </div>
#         </div>
#     </div>

#     <!-- Login Modal -->
#     <div class="modal fade" id="loginModal" tabindex="-1">
#         <div class="modal-dialog">
#             <div class="modal-content">
#                 <div class="modal-header">
#                     <h5 class="modal-title">Iniciar Sesión</h5>
#                     <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
#                 </div>
#                 <div class="modal-body">
#                     <form id="loginForm">
#                         <div class="mb-3">
#                             <label for="loginEmail" class="form-label">Email</label>
#                             <input type="email" class="form-control" id="loginEmail" required>
#                         </div>
#                     </form>
#                 </div>
#                 <div class="modal-footer">
#                     <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
#                     <button type="button" class="btn btn-dark" id="loginBtn">Iniciar Sesión</button>
#                 </div>
#             </div>
#         </div>
#     </div>

#     <!-- Register Modal -->
#     <div class="modal fade" id="registerModal" tabindex="-1">
#         <div class="modal-dialog">
#             <div class="modal-content">
#                 <div class="modal-header">
#                     <h5 class="modal-title">Registrarse</h5>
#                     <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
#                 </div>
#                 <div class="modal-body">
#                     <form id="registerForm">
#                         <div class="row">
#                             <div class="col-md-6 mb-3">
#                                 <label for="registerNombre" class="form-label">Nombre</label>
#                                 <input type="text" class="form-control" id="registerNombre" required>
#                             </div>
#                             <div class="col-md-6 mb-3">
#                                 <label for="registerApellido" class="form-label">Apellido</label>
#                                 <input type="text" class="form-control" id="registerApellido" required>
#                             </div>
#                         </div>
#                         <div class="mb-3">
#                             <label for="registerEmail" class="form-label">Email</label>
#                             <input type="email" class="form-control" id="registerEmail" required>
#                         </div>
#                         <div class="mb-3">
#                             <label for="registerDni" class="form-label">DNI</label>
#                             <input type="text" class="form-control" id="registerDni" required>
#                         </div>
#                         <div class="mb-3">
#                             <label for="registerTelefono" class="form-label">Teléfono</label>
#                             <input type="tel" class="form-control" id="registerTelefono">
#                         </div>
#                         <div class="mb-3">
#                             <label for="registerDireccion" class="form-label">Dirección</label>
#                             <textarea class="form-control" id="registerDireccion" rows="2"></textarea>
#                         </div>
#                     </form>
#                 </div>
#                 <div class="modal-footer">
#                     <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
#                     <button type="button" class="btn btn-dark" id="registerBtn">Registrarse</button>
#                 </div>
#             </div>
#         </div>
#     </div>

#     <!-- Bootstrap 5.0 JS -->
#     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
#     <!-- Custom JS -->
#     <script src="js/api.js"></script>
#     <script src="js/app.js"></script>
#     <script src="js/auth.js"></script>
    
#     <script>
#         // Variables globales
#         let productos = [];
#         let pedidos = [];
#         let clientes = [];

#         // Inicializar página de administración
#         document.addEventListener('DOMContentLoaded', function() {
#             configurarEventListeners();
#             cargarDatos();
#         });

#         // Configurar event listeners
#         function configurarEventListeners() {
#             // Pestañas
#             document.getElementById('productos-tab').addEventListener('click', () => cargarProductos());
#             document.getElementById('pedidos-tab').addEventListener('click', () => cargarPedidos());
#             document.getElementById('estadisticas-tab').addEventListener('click', () => cargarEstadisticas());

#             // Productos
#             document.getElementById('searchProductosBtn').addEventListener('click', buscarProductos);
#             document.getElementById('guardarProductoBtn').addEventListener('click', guardarProducto);

#             // Pedidos
#             document.getElementById('filtroEstado').addEventListener('change', filtrarPedidos);
#             document.getElementById('filtroFecha').addEventListener('change', filtrarPedidos);
#             document.getElementById('actualizarEstadoBtn').addEventListener('click', actualizarEstadoPedido);

#             // Limpiar formularios al cerrar modales
#             document.getElementById('productoModal').addEventListener('hidden.bs.modal', limpiarFormularioProducto);
#         }

#         // Cargar datos iniciales
#         async function cargarDatos() {
#             await cargarProductos();
#             await cargarEstadisticas();
#         }

#         // Cargar productos
#         async function cargarProductos() {
#             try {
#                 API.utils.showLoading();
#                 productos = await API.articulos.obtenerTodos();
#                 renderizarProductos(productos);
#             } catch (error) {
#                 console.error('Error al cargar productos:', error);
#                 API.utils.showAlert('Error al cargar productos', 'danger');
#             } finally {
#                 API.utils.hideLoading();
#             }
#         }

#         // Renderizar productos
#         function renderizarProductos(productosArray) {
#             const tbody = document.getElementById('productos-table-body');
            
#             if (productosArray.length === 0) {
#                 tbody.innerHTML = '<tr><td colspan="7" class="text-center py-4">No se encontraron productos</td></tr>';
#                 return;
#             }

#             tbody.innerHTML = productosArray.map(producto => `
#                 <tr>
#                     <td>${producto.id}</td>
#                     <td>${producto.nombre}</td>
#                     <td>${producto.descripcion || 'N/A'}</td>
#                     <td>${API.utils.formatearMoneda(producto.precio)}</td>
#                     <td>${producto.stock}</td>
#                     <td>
#                         <span class="badge ${producto.activo ? 'bg-success' : 'bg-danger'}">
#                             ${producto.activo ? 'Activo' : 'Inactivo'}
#                         </span>
#                     </td>
#                     <td>
#                         <button class="btn btn-sm btn-outline-primary me-1" onclick="editarProducto(${producto.id})">
#                             <i class="bi bi-pencil"></i>
#                         </button>
#                         <button class="btn btn-sm btn-outline-warning me-1" onclick="actualizarStock(${producto.id}, ${producto.stock})">
#                             <i class="bi bi-box"></i>
#                         </button>
#                         <button class="btn btn-sm btn-outline-danger" onclick="eliminarProducto(${producto.id})">
#                             <i class="bi bi-trash"></i>
#                         </button>
#                     </td>
#                 </tr>
#             `).join('');
#         }

#         // Cargar pedidos
#         async function cargarPedidos() {
#             try {
#                 API.utils.showLoading();
#                 pedidos = await API.pedidos.obtenerTodos();
#                 clientes = await API.clientes.obtenerTodos();
#                 renderizarPedidos(pedidos);
#             } catch (error) {
#                 console.error('Error al cargar pedidos:', error);
#                 API.utils.showAlert('Error al cargar pedidos', 'danger');
#             } finally {
#                 API.utils.hideLoading();
#             }
#         }

#         // Renderizar pedidos
#         function renderizarPedidos(pedidosArray) {
#             const tbody = document.getElementById('pedidos-table-body');
            
#             if (pedidosArray.length === 0) {
#                 tbody.innerHTML = '<tr><td colspan="6" class="text-center py-4">No se encontraron pedidos</td></tr>';
#                 return;
#             }

#             tbody.innerHTML = pedidosArray.map(pedido => {
#                 const cliente = pedido.cliente || clientes.find(c => c.id === pedido.clienteId);
#                 return `
#                     <tr>
#                         <td>${pedido.id}</td>
#                         <td>${cliente ? cliente.nombre + ' ' + cliente.apellido : 'N/A'}</td>
#                         <td>${pedido.fechaPedido ? API.utils.formatearFecha(pedido.fechaPedido) : 'N/A'}</td>
#                         <td>${pedido.total ? API.utils.formatearMoneda(pedido.total) : '$0.00'}</td>
#                         <td>
#                             <span class="badge ${getEstadoBadgeClass(pedido.estado)}">
#                                 ${pedido.estado || 'PENDIENTE'}
#                             </span>
#                         </td>
#                         <td>
#                             <button class="btn btn-sm btn-outline-primary me-1" onclick="cambiarEstadoPedido(${pedido.id}, '${pedido.estado}')">
#                                 <i class="bi bi-arrow-repeat"></i>
#                             </button>
#                             <button class="btn btn-sm btn-outline-info" onclick="verDetallesPedido(${pedido.id})">
#                                 <i class="bi bi-eye"></i>
#                             </button>
#                         </td>
#                     </tr>
#                 `;
#             }).join('');
#         }

#         // Cargar estadísticas
#         async function cargarEstadisticas() {
#             try {
#                 const stats = await API.estadisticas.obtenerGenerales();
#                 document.getElementById('stat-productos').textContent = stats.totalProductos;
#                 document.getElementById('stat-clientes').textContent = stats.totalClientes;
#                 document.getElementById('stat-pedidos').textContent = stats.totalPedidos;
                
#                 const productosActivos = stats.productos.filter(p => p.activo).length;
#                 document.getElementById('stat-productos-activos').textContent = productosActivos;
                
#             } catch (error) {
#                 console.error('Error al cargar estadísticas:', error);
#             }
#         }

#         // Funciones auxiliares
#         function getEstadoBadgeClass(estado) {
#             switch (estado) {
#                 case 'PENDIENTE': return 'bg-warning';
#                 case 'PROCESANDO': return 'bg-info';
#                 case 'ENVIADO': return 'bg-primary';
#                 case 'ENTREGADO': return 'bg-success';
#                 case 'CANCELADO': return 'bg-danger';
#                 default: return 'bg-secondary';
#             }
#         }

#         function limpiarFormularioProducto() {
#             document.getElementById('productoForm').reset();
#             document.getElementById('productoId').value = '';
#             document.getElementById('productoModalTitle').textContent = 'Nuevo Producto';
#             document.getElementById('productoActivo').checked = true;
#         }

#         // Funciones de productos
#         async function guardarProducto() {
#             const productoData = {
#                 nombre: document.getElementById('productoNombre').value.trim(),
#                 descripcion: document.getElementById('productoDescripcion').value.trim(),
#                 precio: parseFloat(document.getElementById('productoPrecio').value),
#                 stock: parseInt(document.getElementById('productoStock').value),
#                 activo: document.getElementById('productoActivo').checked
#             };

#             if (!productoData.nombre || !productoData.precio || !productoData.stock) {
#                 API.utils.showAlert('Por favor completa todos los campos obligatorios', 'warning');
#                 return;
#             }

#             try {
#                 API.utils.showLoading();
#                 const productoId = document.getElementById('productoId').value;
                
#                 if (productoId) {
#                     await API.articulos.actualizar(productoId, productoData);
#                     API.utils.showAlert('Producto actualizado correctamente', 'success');
#                 } else {
#                     await API.articulos.crear(productoData);
#                     API.utils.showAlert('Producto creado correctamente', 'success');
#                 }

#                 const modal = bootstrap.Modal.getInstance(document.getElementById('productoModal'));
#                 modal.hide();
#                 await cargarProductos();

#             } catch (error) {
#                 console.error('Error al guardar producto:', error);
#                 API.utils.showAlert('Error al guardar producto: ' + error.message, 'danger');
#             } finally {
#                 API.utils.hideLoading();
#             }
#         }

#         async function editarProducto(id) {
#             try {
#                 API.utils.showLoading();
#                 const producto = await API.articulos.obtenerPorId(id);
                
#                 document.getElementById('productoId').value = producto.id;
#                 document.getElementById('productoNombre').value = producto.nombre;
#                 document.getElementById('productoDescripcion').value = producto.descripcion || '';
#                 document.getElementById('productoPrecio').value = producto.precio;
#                 document.getElementById('productoStock').value = producto.stock;
#                 document.getElementById('productoActivo').checked = producto.activo;
#                 document.getElementById('productoModalTitle').textContent = 'Editar Producto';

#                 const modal = new bootstrap.Modal(document.getElementById('productoModal'));
#                 modal.show();

#             } catch (error) {
#                 console.error('Error al cargar producto:', error);
#                 API.utils.showAlert('Error al cargar producto', 'danger');
#             } finally {
#                 API.utils.hideLoading();
#             }
#         }

#         async function actualizarStock(id, stockActual) {
#             const nuevoStock = prompt(`Stock actual: ${stockActual}\nIngresa el nuevo stock:`);
#             if (nuevoStock !== null && !isNaN(nuevoStock) && nuevoStock >= 0) {
#                 try {
#                     API.utils.showLoading();
#                     await API.articulos.actualizarStock(id, parseInt(nuevoStock));
#                     API.utils.showAlert('Stock actualizado correctamente', 'success');
#                     await cargarProductos();
#                 } catch (error) {
#                     console.error('Error al actualizar stock:', error);
#                     API.utils.showAlert('Error al actualizar stock', 'danger');
#                 } finally {
#                     API.utils.hideLoading();
#                 }
#             }
#         }

#         async function eliminarProducto(id) {
#             if (confirm('¿Estás seguro de que deseas eliminar este producto?')) {
#                 try {
#                     API.utils.showLoading();
#                     await API.articulos.eliminar(id);
#                     API.utils.showAlert('Producto eliminado correctamente', 'success');
#                     await cargarProductos();
#                 } catch (error) {
#                     console.error('Error al eliminar producto:', error);
#                     API.utils.showAlert('Error al eliminar producto', 'danger');
#                 } finally {
#                     API.utils.hideLoading();
#                 }
#             }
#         }

#         // Funciones de pedidos
#         function cambiarEstadoPedido(id, estadoActual) {
#             document.getElementById('pedidoIdEstado').value = id;
#             document.getElementById('nuevoEstado').value = estadoActual;
#             const modal = new bootstrap.Modal(document.getElementById('estadoPedidoModal'));
#             modal.show();
#         }

#         async function actualizarEstadoPedido() {
#             const pedidoId = document.getElementById('pedidoIdEstado').value;
#             const nuevoEstado = document.getElementById('nuevoEstado').value;

#             if (!nuevoEstado) {
#                 API.utils.showAlert('Por favor selecciona un estado', 'warning');
#                 return;
#             }

#             try {
#                 API.utils.showLoading();
#                 await API.pedidos.actualizarEstado(pedidoId, nuevoEstado);
#                 API.utils.showAlert('Estado actualizado correctamente', 'success');
                
#                 const modal = bootstrap.Modal.getInstance(document.getElementById('estadoPedidoModal'));
#                 modal.hide();
#                 await cargarPedidos();

#             } catch (error) {
#                 console.error('Error al actualizar estado:', error);
#                 API.utils.showAlert('Error al actualizar estado', 'danger');
#             } finally {
#                 API.utils.hideLoading();
#             }
#         }

#         function verDetallesPedido(id) {
#             API.utils.showAlert('Funcionalidad de detalles en desarrollo', 'info');
#         }

#         // Funciones de búsqueda y filtrado
#         function buscarProductos() {
#             const query = document.getElementById('searchProductos').value.toLowerCase();
#             const productosFiltrados = productos.filter(producto =>
#                 producto.nombre.toLowerCase().includes(query) ||
#                 (producto.descripcion && producto.descripcion.toLowerCase().includes(query))
#             );
#             renderizarProductos(productosFiltrados);
#         }

#         function filtrarPedidos() {
#             const estado = document.getElementById('filtroEstado').value;
#             const fecha = document.getElementById('filtroFecha').value;
            
#             let pedidosFiltrados = pedidos;
            
#             if (estado) {
#                 pedidosFiltrados = pedidosFiltrados.filter(pedido => pedido.estado === estado);
#             }
            
#             if (fecha) {
#                 pedidosFiltrados = pedidosFiltrados.filter(pedido => {
#                     const fechaPedido = new Date(pedido.fechaCreacion).toISOString().split('T')[0];
#                     return fechaPedido === fecha;
#                 });
#             }
            
#             renderizarPedidos(pedidosFiltrados);
#         }

#         // Hacer funciones disponibles globalmente
#         window.editarProducto = editarProducto;
#         window.actualizarStock = actualizarStock;
#         window.eliminarProducto = eliminarProducto;
#         window.cambiarEstadoPedido = cambiarEstadoPedido;
#         window.verDetallesPedido = verDetallesPedido;
#     </script>
# </body>
# </html> 

